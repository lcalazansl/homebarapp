<div class="main-content container">
  <%= render "components/cabinet", user_ingredients: @user_ingredients_in_stock, found_cocktails: @filtered_cocktails %>
  <div class="index g-0">
    <% if @filtered_cocktails.empty? %>
      <div>
        <h1>
          All Our Cocktails
        </h1>
      </div>
      <div class="cards">
        <% @cocktails.each do |cocktail| %>
          <%# LOGIC for saved cocktails display %>
          <% classes = {  normal: '' } %>
          <% @saved_cocktails.each do |item| %>
            <% if item.cocktail_id == cocktail.id %>
              <%# <% @custom_class = "saved_cocktail_orange" %>
              <% classes[cocktail.id] = "saved_cocktail_orange" %>
            <% end %>
          <% end %>
          <div class="index-card-wrap" id="myBtn-<%= cocktail.id %>">
            <div class="index-card-header">
              <div class="index-card-stock <%= classes[cocktail.id] %>">
                <p>
                  Ready To Go
                </p>
              </div>
              <div class="index-cocktail-name">
                <h4>
                  <%= cocktail.name.titleize %>
                </h4>
              </div>
            </div>
            <% all_ingredient_names_of_found_cocktails = [] %>
            <div class="index-card-bottom">
              <%# <h2> <%= link_to cocktail.name.titleize, cocktail_path(cocktail.id) %>
              <% cocktail.measurements.each do |measurement| %>
                <% all_ingredient_names_of_found_cocktails << @ingredients.find(measurement.ingredient_id).name.titleize %>
              <% end %>
              <p>
                <%= all_ingredient_names_of_found_cocktails.to_sentence %>
              </p>
              <%# ADD TO MY BAR BUTTON DISPLAY LOGIC %>
              <% saved_cocktail = SavedCocktail.find_by(user_id: current_user.id, cocktail_id: cocktail.id)  %>
              <% if saved_cocktail %>
                <%= button_to "", saved_cocktail_path(saved_cocktail), method: :delete, class:"fa-solid fa-circle-minus fa-2xl" %>
              <% else %>
                <%= button_to "", saved_from_index_path(cocktail.id), method: :post, class:"fa-solid fa-circle-plus fa-2xl" %>
              <% end %>
            </div>
          </div>
          <%# Modal, non-displayed, which is the Show Card %>
          <%= render 'components/modal', cocktail: cocktail %>
        <% end %>
      </div>
    </div>
    <% else %>
      <h1>
        Make these cocktails
      </h1>
      <div class="index">
        <% if @filtered_cocktails %>
          <div class="cards">
            <% @filtered_cocktails.each do |cocktail| %>
              <%# LOGIC for saved cocktails display %>
              <% classes = {  normal: '' } %>
              <% @saved_cocktails.each do |item| %>
              <%# raise %>
                <% if item.cocktail_id == cocktail.id %>
                  <%# <% @custom_class = "saved_cocktail_orange" %>
                  <% classes[cocktail.id] = "saved_cocktail_orange" %>
                <% end %>
              <% end %>
                <div class="index-card-wrap <%= classes[cocktail.id] %>" id="myBtn-<%= cocktail.id %>">
                  <div class="index-card-header">
                    <div class="index-card-stock">
                      <p>
                        <% case %>
                          <%# raise %>
                        <% when @ready.include?(cocktail) %>
                          <%#= 'Ready to go' %>
                          <i class="fa-solid fa-user-check"></i>
                        <% when @missing_one.include?(cocktail) %>
                          <%#= '-1' %>
                          <i class="fa-solid fa-basket-shopping"></i>
                        <% when @missing_two.include?(cocktail) %>
                          <%#= '-2' %>
                          <i class="fa-solid fa-basket-shopping"></i>
                          <i class="fa-solid fa-basket-shopping"></i>
                        <% end %>
                      </p>
                    </div>
                    <div class="index-cocktail-name">
                      <h4>
                        <%= cocktail.name.titleize %>
                      </h4>
                    </div>
                  </div>
                  <% all_ingredient_names_of_found_cocktails = [] %>
                  <div class="index-card-bottom">
                    <%# <h2> <%= link_to cocktail.name.titleize, cocktail_path(cocktail.id) %>
                    <% cocktail.measurements.each do |measurement| %>
                      <% all_ingredient_names_of_found_cocktails << @ingredients.find(measurement.ingredient_id).name.titleize %>
                    <% end %>
                    <p>
                      <%= all_ingredient_names_of_found_cocktails.to_sentence %>
                    </p>
                    <%# ADD TO MY BAR BUTTON DISPLAY LOGIC %>
                    <% saved_cocktail = SavedCocktail.find_by(user_id: current_user.id, cocktail_id: cocktail.id)  %>
                    <% if saved_cocktail %>
                      <%= button_to "", saved_cocktail_path(saved_cocktail), method: :delete, class:"fa-solid fa-circle-minus fa-2xl" %>
                    <% else %>
                      <%= button_to "", saved_from_index_path(cocktail.id), method: :post, class:"fa-solid fa-circle-plus fa-2xl" %>
                    <% end %>
                  </div>
                </div>
                <%# Modal, non-displayed, which is the Show Card %>
                <%= render 'components/modal', cocktail: cocktail %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
